---
import Layout from "@/layouts/Layout.astro";
import { formatDate } from "@/lib/format";
import { getPostsByType, getPublishedDate, loadPublishedDates, sortByDate } from "@/lib/posts";

const publishedDates = loadPublishedDates();
const posts = sortByDate(getPostsByType("publication"), publishedDates);
---

<Layout title="Publications">
	<header>
		<h1>Publications</h1>
		<p class="subtitle">긴 기술 글, 튜토리얼, 심층 분석</p>
	</header>

	{posts.length === 0 ? (
		<p>아직 글이 없습니다.</p>
	) : (
		<div class="posts">
			{posts.map((post) => {
				const date = getPublishedDate(post, publishedDates);
				return (
					<article>
						<h2><a href={`/publications/${post.slug}`}>{post.title}</a></h2>
						<time datetime={date}>{formatDate(date)}</time>
						{post.description && <p class="description">{post.description}</p>}
						{post.tags.length > 0 && <p class="tags">{post.tags.join(", ")}</p>}
					</article>
				);
			})}
		</div>
	)}
</Layout>

<style>
	header {
		margin-bottom: 2rem;
	}
	.subtitle {
		color: #666;
		margin-top: 0.5rem;
	}
	.posts {
		display: flex;
		flex-direction: column;
		gap: 2rem;
	}
	article {
		padding-bottom: 2rem;
		border-bottom: 1px solid #eee;
	}
	article:last-child {
		border-bottom: none;
	}
	article h2 {
		margin-bottom: 0.5rem;
	}
	article h2 a {
		text-decoration: none;
	}
	article h2 a:hover {
		text-decoration: underline;
	}
	article time {
		display: block;
		color: #666;
		font-size: 0.875rem;
	}
	.description {
		margin-top: 0.5rem;
		color: #444;
	}
	.tags {
		margin-top: 0.5rem;
		font-size: 0.875rem;
		color: #666;
	}
</style>
